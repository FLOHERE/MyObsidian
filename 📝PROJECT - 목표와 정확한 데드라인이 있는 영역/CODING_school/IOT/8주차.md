# 기본 클래스(Serial, String)

## 1. 기본 클래스
- 아두이노 프로그램은 C/C++ 기반
- C++ 클래스 : 객체 추상화 
	- 구체적인 동작 과정을 숨김
	- 맴버 함수 호출 -> 결과값만 얻어올수 있어 프로그램 작성이 쉽고 간단
	- 실질적으로 코드가 동작하는 부분은 loop() 부분임
- Serial 과 String 각각 시리얼 통신과 문자열 처리를위한 클래스

## 2. Serial
- 아두이노 보드가 컴퓨터나 주변 장치와 시리얼 통신을 수행하기 위해 필요한 클래스
- 시리얼 통신 작동 방식 : USART(Universal Synchronous / Asynchronous Receiver Transmitter) or UART 로 알려진 방식으로 RS-232C 프로토콜에 정의된 내용 중 데이터 송수신 수행
![[Pasted image 20240531174327.png]]

- 아두이노 우노 : 디지털 0번(RX), 1번(TX)를 통하거나 USB연결을 통해 시리얼 통신을 사용
- 시리얼 통신을 사용하는 경우 0번과 1번핀은 디지털 입출력으로 사용할수 없다.
- 전송속도는 baud rate을 사용(1초동안 전달되는 데이터 비트의 개수)

### if(Serial)
- 시리얼 포트가 준비되어있는지 검사
	- 준비 됐으면 true
	- 아니면 false
### available
```C
int available(void)
```
- 매개변수 : 없음
- 반환값 : 시리얼 포트 수신 데이터 버퍼에 저장된 데이터 바이트 수

### begin
```C
void begin(unsigned long baud)
void begin(unsigned long baud, byte config)
```
- 매개변수
	- baud : 속도
	- config : 데이터 비트 수, 패리티, 정지 비트 설정
- 반환값 : 없음

>[!warning] SERIAL_8N1
>8 : 데이터 비트(5,6,7,8)
>N : 패리티 비트(N = 없다는 뜻),(E = 짝수),(O = 홀수)
>1 : 정지 비트(1,2)

### end
- 시리얼 통신을 종료
```C
void end(void)
```
- 매개변수 : 없음
- 반환값 : 없음

### find
- 시리얼 통신 수신 버퍼에서 주어진 문자열 target이 발견되면 true
	- 검색시간이 초과되면 false 반환
```C
bool find(char *target)
```
- 매개변수
	- target : 탐색 문자열
- 반환값 : true/false

>[!note] Buffer(버퍼)
>컴퓨터나 마이크로 컨트롤러에서 데이터를 송신할떄 일시적으로 데이터를 저장하는 영역
>(임시 저장소)

### findUntil
- 시리얼 통신 수신 버퍼에서 주어진 문자열 target 이나, 종료 문자열 terminator가 발견 -> true
	- 검색 시간 초과시 -> false
```C
bool findUntil(char *target, char *terminator)
```

### flush
- 시리얼 통신 송신 버퍼에 있는 데이터가 전송 완료할때까지 대기
	- 매개변수 : 없음
	- 반환값 : 없음
```C
void flush(void)
```

### parseFloat
- 시리얼 통신 수신 버퍼에서 첫번째 유효한 실수를 반환
- 수신 버퍼가 비어있거나 실수가 발견 X -> 0 반환
	- 매개변수 : 없음
	- 반환값 : 수신 버퍼에서 발견된 첫번째 유효한 float 형 데이터
```C
float parseFloat(void)
```

### parseInt
- 시리얼 통신 수신 버퍼에서 첫번째 유효한 정수를 반환
- 수신버퍼가 비어있거나 정수가 발견되지 않으면 0반환
	- 매개변수 : 없음
	- 반환값 : 수신 버퍼에서 발견된 첫번째 유효한 int형 데이터
```C
int parseInt(void)
```

### peek
- 시리얼 통신 수신 버퍼의 첫번째 바이트 데이터를 반환
- 수신버퍼가 비어있는 경우 -1 반환
	- 매개변수 : 없음
	- 반환값 : 시리얼 통신 수신 버퍼의 첫번째 바이트 데이터 또는 -1
```C
int peek(void)
```

### print
- 출력값 value를 ASCII 형식으로 시리얼 포트로 출력
- Fomat은 정수의 경우 출력 형식을 2,8,10,16진법 중 선택
- 실수의 소수점 이사 자릿수를 지정할수 있음
	- 매개변수
		- value : 출력값(char, char배열,String, 정수, 실수 등)
		- format : 출력 형식
	- 반환값 : 시리얼 포트로 출력된 바이트 수
```C
size_t print(value, format)
```

### println
- 출력값 value를 ASCII 형식으로 시리얼 포트로 출력하고 줄바꿈
- Fomat은 정수의 경우 출력 형식을 2,8,10,16진법 중 선택
- 실수의 소수점 이사 자릿수를 지정할수 있음
	- 매개변수
		- value : 출력값(char, char배열,String, 정수, 실수 등)
		- format : 출력 형식
	- 반환값 : 시리얼 포트로 출력된 바이트 수
```C
size_t println(value, format)
```

### read
- 시리얼 통신 수신 버퍼에서 첫번째 문자를 읽어 반환
- 수신 버퍼가 비어있는 경우 -1 반환
	- 매개변수 : 없음
	- 반환값 : 시리얼 통신 수신 버퍼의 첫번째 문자 or -1
```C
int read(void)
```

### readBytes
- 시리얼 통신 수신 버퍼의 문자를 읽어 버퍼에 저장
- length에 지정한 바이트 수의 문자를 읽었거나 시간 초과 -> 종료
  입력받은 문자의 수 반환
	- 매개변수 
		- buffer : 입력 문자를 저장한 버퍼
		- length : 입력받을 최대 문자수 
	- 반환값 : 입력받은 문자 수
```C
size_t readBytes(char *buffer, size_t length)
```

### readBytesUntil
- 시리얼 통신 수신 버퍼의 문자를 읽어 버퍼에 저장
- length에 저장한 바이트 수의 문자를 읽었거나 시간 초과 -> 종료 문자가 발견된 경우 종료,
  입력받은 문자의 수 반환
	- 매개변수
		- terminator : 종료문자
		- buffer : 입력 문자를 저장한 버퍼
		- length : 입력받을 최대 문자 수
	- 반환값 : 입력받은 문자수 
```C
size_t readBytesUntil(char terminator, char *buffer, size_t length)
```

### setTimeout
- readBytes 함수나 readBytesUntil 함수를 통해 데이터를 읽어들일때의 대기 시간을 밀리초 단위로 설정
	- 매개변수
		- timeout : 대기시간
	- 반환값 : 없음
```C
void setTimeout(unsigned long timeout)
```

### write
- 이진 데이터를 시리얼 포트로 출력, 바이트 수 반환
- 이진 형식으로 출력 -> 숫자 출력시 print or println 함수 사용
- 문자열 한정 print = write
	- 매개변수
		- ch : 출력 문자
		- str : 출력 문자열
		- buffer : 출력 데이터 열
		- size : 버퍼의 크기
	- 반환값 : 출력한 바이트 수
```C
size_t write(uint8_t ch)
size_t write(const char *str)
size_t write(const uint8_t *buffer, size_t size)
```

### serialEvent
- Serial 클래스의 멤버 함수가 아니며, 수신 버퍼에 데이터가 수신된 경우 호출되는 함수
- main 함수의 구조에서 살펴보면 loop 함수가 호출된 후 serialEventRun 함수에서 시리얼 통신수신 버퍼를 검사하며, 데이터가 수신된 경우 seriallEvent 함수를 호출하도록 되어 있다.
```C
void serialEvent(){
	//statements
}
```

## 3. String
- 문자열을 다루기 위한 클래스 
- C에서는 문자열을 다루기 위한 데이터형이 별도로 정의되어 있지않으며, 문자 배열을 이용-> 문자열을 처리 -> 번거로움(+많은 주의 필요)
- C++에서는 문자열을 다루기 위한 클래스 제공 -> String클래스
- 문자열 연결, 비교, 찾기, 바꾸기 등 지원
- String 클래스 > 문자 배열 (메모리 공간 차지)
  but 다양한 작업 간편하게 처리

- String 클래스의 생성자로, 정수, 문자, 문자배열, String 객체 등 다양한 종류의 데이터 형으로 부터 String 객체 생성
- 정수가 value로 주어진 경우 진법을 지정