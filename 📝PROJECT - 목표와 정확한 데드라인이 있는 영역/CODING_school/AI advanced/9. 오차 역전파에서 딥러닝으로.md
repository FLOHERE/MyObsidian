- XOR 문제를 풀었음에도, 은닉층에 포함된 가중치를 업데이트 할 방법을 찾지 못함
	- "오차 역전파"로 해결
	- = 딥러닝의 탄생

## 1. 딥러닝의 태동, 오차 역전파
- 오차 역전파 : 출력값과 실제 정답 사이의 오차를 줄이기 위해 은닉층을 포함한 모든 가중치들을 조정하는것.
	- 은닉층에 경사하강법을 쓰기 위한 방식
	- 순전파 : 입력층, 은닉층, 출력층을 한번 계산해서 예측값을 만드는것.
	- 역전파 : 이 오차를 바탕으로 출력층에서 은닉층 방향으로 가중치 업데이트 하는것.(기울기 계산)
- 학습 : 데이터를 통해 스스로 가중치를 조절하는 것
	- 이때까지 입,출력값을 알고 가중치와 바이어스를 미리 알아본 후 대입 => 모델링X
- 은닉층의 가중치 업데이트 방법 : 경사 하강법 이용
	- 경사 하강법 : 임의의 가중치 선언, 결괏값 이용해 오차를 구함 -> 이 오차가 최소인 지점으로 계속 조금씩 이동 시키는 것.
		- 오차가 최소인 지점  = 미분 했을때 기울기가 0
		- 경사 하강법은 단일 퍼셉트론(입,출력층만 존재하는 형태)만 가능
		- 은닉층이 생기며 두번의 경사 하강법 필요

![[Pasted image 20250612000826.png]]

- 다층 퍼셉트론의 출력층 오차 계산법
	1. 순전파로 초깃값 정해짐
	2. 초깃값의 가중치로 만들어진 값과 실제 값 비교
	3. 첫번째 가중치 수정
	4. 두번째 가중치 수정
- 목적 : 출력층의 오차 최소화
	- 근데 은닉층은? 겉으로 들어나지 않음. 출력값이 없다.(비교 불가)
	  => 다시 출력층 사용으로 해결
	- 오차 두개를 모두 계산하여 편미분 함

![[Pasted image 20250612001154.png]]

- 가중치 공식

![[Pasted image 20250612001406.png]]

- 델타식 : `out(1-out)` 형태
	- 은닉층의 숫자가 늘어도 이러한 형태가 계속 나타남
	  => 이를 이용해 깊은 층의 계산도 가능
- 오차 역전파로 깊은 층을 만들게 되면서 딥러닝 시작

>[!note] 체인 룰이란?
>함수가 여러겹일때 미분값을 곱해서 연결하는 규칙
>1. 예측이 틀린 정도에 따른 손실 영향
>2. 가중치가 예측에 얼마나 영향을 주는지 
>- 사용하는 이유 : 오차를 역으로 전달하기 위해서

## 2. 활성화 함수와 고급 경사 하강법
- 문제점 발생 : 역전파 사용시 (미분)값이 점점 작아진다.
	- 처음 층까지 가중치 업데이트가 전달되지 않음.
	- why? => sigmoid 때문!
		- 시그모이드는 미분하면 최대치가 0.25임
		  -> 1>0.25 이므로 계속 곱하면'0'에 가까워 진다.
		- 여러 층을 거치며 기울기가 점점 사라짐
			- 가중치 수정이 어렵다
- 해결법 : `Relu` 라는 활성화 함수 사용

![[Pasted image 20250615202017.png]]

### 1. Relu 함수
- `Relu` 함수 : x가 0보다 작을때 모든 값을 0으로 처리, 0보다 큰 값은 x를 그대로 사용하는 방법
	- 렐루 사용시 여러번 오차 역전파가 진행 되어도 맨 처음 층까지 값이 남아 있게 된다.

![[Pasted image 20250615202136.png]]


## 3. 속도와 정확도 문제를 해결하는 고급 경사 하강법
- 경사하강법 : 가중치 업데이트 오차를 최소로 만듦
	- 단점 : 계산량이 많다
		- 속도가 느려 최적 해를 찾기 전 최적화 과정이 멈출수 있다.
	- 해결 : '고급 경사 하강법' 사용
- 확률적 경사 하강법 : 랜덤하게 데이터를 추출하여 빠르게 최적 해에 근사한 값을 낸다.

### 1. 모멘텀
- 뜻 : 관성, 탄력, 가속도
- 모멘텀SGD(모멘텀 확률적 경사 하강법) :  경사 하강법에 탄력을 더해주는것.
	- 경사 하강법(매번 기울기를 구함) + 오차 수정 전 바로 앞의 수정값과 방향 참조 => 일정한 비율로 수정
	- 수정 방향이 양수 방향 한번, 음수 방향 한번 수행됨 -> 지그재그로 일어나는 현상 줄어듦.
	- 이전 이동 값 고려, 일정 비율만큼 다음 값 결정 -> 관성 효과
- 아담(adam) : 정확도와 속도 모두 향상시키는 고급 경사법.