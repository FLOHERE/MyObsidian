## 1. 딥러닝과 데이터
- 데이터 양이 무작정 많다고 해서 무조건 좋은건 아니다.
- 좋은 데이터 = 정제된 데이터
	- 정제된 데이터란?
	  1. 왜곡되지 않은 데이터
	  2. 불필요한 정보가 포함되지 않은 데이터
	  3. 한쪽으로 치우처지지 않은 데이터
- 이처럼 잘 정제된 데이터형식으로 바꾸는것이 중요하다!
	- pandas, 맷플롯립 사용으로 데이터 분석
## 2. 피마 인디언 데이터 분석하기
- 피마 인디언 : 비만이 환경과 유전자 모두 영향을 미치는 질병이라는 것을 알려주는 좋은 사례
	- 원래는 비만이 한명도 없었는데 미국의 패스트푸드 문화를 접하자 비만률이 급증
- 딥러닝을 구동하려면 반드시 속성과 클래스를 먼저 구분
	- 모델의 정확도 향상을 위한 데이터 추가 및 재가공 필요할수도 있음. 
	  => 데이터 내용과 구조 파악 중요

![[Pasted image 20250617131559.png]]

- 샘플수 : 768
- 속성 : 8
	1. pregnant : 과거 임신 횟수
	2. plasma : 포도당 부하 검사(2시간 후 공복 혈당 농도)
	3. pressure : 확장기 혈압
	4. thickness : 삼두근 피부 주름 두깨
	5. insulin : 혈청 인슐린
	6. BMI : 체질량 지수
	7. pdeigree : 당뇨병 가족력
	8. age : 나이
- 라벨(클래스) : 당뇨(1), 당뇨 아님(0)
## 3. 판다스를 활용한 데이터 조사
1. 데이터 양이 많다
2. 복잡하다
3. 보기 쉽게 그래프로 표현 하자!
4. *Pandas* 라이브러리 사용!
	- 다양한 포멧 데이터 + numpy 기능 있음.

```python
df = pd.read_csv('./data/pima-indians-diabetes3.csv')
# pd : pandas 라이브러리 사용, 통계를 보여준다. 데이터프레임으로 저장

df.head(5) # 데이터의 첫 다섯줄 불러옴
```

- `df` (데이터 프레임) : 표(엑셀파일)를 프로그래밍 안에서 다룰수 있게 한다.
	- 헤더(header) : csv 파일의 데이터를 설명 하는 한줄 파일
	- `head()` : 헤더를 불러오는 함수

>[!note] csv 란?
>comma seperated values의 약어
>쉼표(,)로 구분된 데이터들의 모음 이라는 뜻임

```python
df["diabetes"].value_counts()
# 당뇨병 환자 칼럼의 값이 몇개 있는지 알려주는 코드

df.describe()
# 정보별 샘플 수(count), 평균(mean), 표준편차(std), 최솟값(min), 백분위 수로 25%, 50%, 75%에 해당하는 값, 최대값(max)
```

- `df["칼럼명"]` : 데이터 프레임의 특정 칼럼을 불러온다.
	- `value_countes()` 함수 : 각 컬럼의 값이 몇개씩 있는지 알려준다.
- `df.describe` : 각 항목의 자세한 정보

```python
df.corr() # 각 항목의 상관 관계
```

- `df.corr()` : 각 항목의 상관관계를 나타낸다. 양수 또는 음수로 표시됨
	- 음수로 표시되어도 서로 관계가 있음
		- 양수 : a가 증가할때 b도 같이 증가
		- 음수 : a가 증가하면 b는 감소

![[Pasted image 20250617164133.png]]

>[!note] 맷플롯립과 시본의 역할
>- 맷플롯립 : 파이썬에서 그래프를 그려준다(그래프 크기, 색상)
>- 시본 : 그래프에 가시성 추가

```python
colormap = plt.cm.gist_heat # 그래프의 색상 구성을 정합니다.
plt.figure(figsize = (12,12)) # 그래프의 크기를 정합니다.

sns.heatmap(df.corr(), linewidths = 0, 1, vmax = 0.5, cmap = colormap,
linecolor = 'white', annot = True)
plt.show()
```

- `heatmap()`(시본 라이브러리 함수) : 항목 두개를 짝지어서 각각의 패턴 변화 관찰
	- 0에 가깝게 출력 : 전혀 다른 패턴으로 변화시
	- 1에 가깝게 출력 : 비슷한 패턴으로 변할시
	- `vmax` : 색상의 밝기 조절하는 인자
	- `cmpa` : 미리 정해진 맷플롯립 색상의 설정 값을 불러옴.

![[Pasted image 20250617165538.png]]

- *당뇨병 발병 여부를 가리키는 diabetes 항목* 주목!
	- pregnant~age 까지 상관도가 숫자로 표시되어 있고 숫자가 높을수록 밝은 색상으로 채워져 있다.
	- plasma(공복 혈당 농도) 와 BMI(체질량 지수)가 diabetes 항목과 상관 관계가 높다는 것을 알수있음.
	- 두 항목만 따로 떼내어 당뇨의 발병 여부와 어떤 관계가 있는지 알아보자
## 4. 중요한 데이터 추출하기

```python
plt.hist(x = [df.plasma[df.diabetes == 0], df.plasma[df.diabetes==1]], bins = 30, hsttype = 'barstacked', label = ['normal', 'diabetes'])
# bins = 30 : x축 막대 개수
# histtype = 'barstacked' : 여러 데이터가 쌓여있는 형태의 막대바 생성

plt.legend()
```

- `hist()`(맷플롯립) : 히스토그램 그림을 그려주는 함수
	- `df.plasma[]` : 플라즈마 칼럼
	- `[df.diabetes==0]` , `[df.diabetes==1]`  : diabetes 값이 0과 1인것을 구분함.

![[Pasted image 20250617170500.png]]\

- 노란색 : 당뇨
- 파란색 : 정상인
	- plasma(공복 혈당 농도)가 높을수록 당뇨인 경우가 많다!!

- BMI를 기준으로 각각 정상과 당뇨가 어느정도 비율로 분포하는지 살펴보자

```python
plt.hist(x = [df.bmi[df.diabetes==0], df.bmi[df.diabetes==1]], bins = 30, histtype = 'barstacked', label = ['normal', 'diabetes'])
plt.legend()
```

![[Pasted image 20250617170834.png]]

- BMI 가 높아질 경우 당뇨의 발병률도 함께 증가하는 추세인것을 확인 가능
- 결과에 미치는 영향이 큰 항목을 발견하는것을 '데이터 전처리 과정' 중 하나다.
	- 데이터 전처리 과정은 성능 향상에 중요한 역할을 한다.

>[!note] 데이터 전처리 과정
>결과에 미치는 영향이 큰 항목을 발견하거나, 데이터에 빠진 값이 있다면 평균이나 중앙값으로 대치 하거나, 흐름에서 크게 벗어나는 이상치를 제거하는 과정 등 데이터 전처리에 포함될 수 있다.

## 5. 피마 인디언 당뇨병 예측 실행

- `iloc[]` 함수 : X, y 각각 지정
	- 데이터 프레임에서 대괄호 안에 정한 범위만큼 가져와 저장하게 함.

```python
X = df.iloc[:, 0:8] # 세부 정보를 X
y = df.iloc[:,8] # 당뇨병 여부를 y로 지정
```

- 모델 구조 설정
	- 이전과 달라진 점 : 은닉층 하나 더 추가됨.

```python
model = Sequential()
model.add(Dense(12, input_dim = 8, activation = 'relu', name = 'Dense_1'))
model.add(Dense(8, activation = 'relu', name = 'Dense_2'))
model.add(Dense(1, activation = 'sigmoid', name = 'Dense_3'))
model.sumary();
```

- 아래 사진은 `model.sumary()` 함수의 실행 결과
- `model.sumary()` : 층과 층의 연결을 보여줌
	1. Layer : 층의 이름과 유형(층 이름은 자동 생성 or name = '층' 으로 정할수 있음)
		1. Dense_1 : 입력 + 첫번째 은닉 연결
		2. Dense_2 : 첫번째 은닉 + 두번째 은닉 연결
		3. Dense_3 : 두번째 은닉 + 세번째 은닉 연결
	2. Output Shape : 각 층에 몇개의 출력이 발생 하는지 나타냄
		- \[None, 12]
			- None : 행(샘플) 수(batch_size에서 정한만큼 입력되므로 따로 정할 필요 없다.)
			- 12 : 열(속성)의 수
	3. Param : 파라미터 수(가중치 + 바이어스)
		- 첫번째 은닉층 입력값 = 8, 
		 거치게 되는 노드 수 = 12,
		 각 노드에는 바이어스가 하나씩 있다.
		  => (12 * 8) + 12 = 108
	4. 파라미터를 합산한 값
 
![[Pasted image 20250617233153.png]]

![[Pasted image 20250617233233.png]]





