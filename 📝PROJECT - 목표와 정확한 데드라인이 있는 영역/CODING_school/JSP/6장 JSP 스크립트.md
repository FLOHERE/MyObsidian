- 자바 구현 스크립트 : 스크립트가 자바 언어로 구현됨
	- 이로 인해 WAS가 처리 X -> 자바 환경이 처리함
	- WAS는 단지 자바가 처리한 결과를 응답 문서에 포함
- 자바 실행 환경 담당 : JSP 페이지에서 자바로 구현되는 스크립트 부분
- WAS 담당 : 자바 구현 스크립트 제외한 부분
	- WAS가 담당하는 두가지 부분
		1. 정적 요소 : JS(자바 스크립트)
		2. 동적 요소 : JSP 스크립트(액션 태그, JSTL태그, 표현 언어, 커스텀 태그 등등)

>[!warning] 주의!
>- JS : 클라이언트에서 동적, 서버에서 정적임
>- JSP, java: 클라이언트에서 정적, 서버에서 동적임

- JSP 페이지의 스크립트 요소
	- WAS 처리
		- 정적 요소
		- JSP 스크립트 요소
		- 액션 태그
		- JSTL 태그
		- EL(expression Language) = 표현언어
		- 커스텀 태그
	- 자바 실행환경 처리
		- 자바 구현 스크립트 요소
		- 스크립트 릿
		- 표현식
		- 함수 선언부

- JSP 페이지에 자바 구현 스크립트 포함하는 방법
	- 자바 / 자바 X 부분 -> 얘네 구분하기
	- 공간 구분자 :  자바 공간과 나머지 공간 구분을 위한 태그
	  (웹페이지의 레이아웃이나 컨텐츠를 구성하는데 사용되는 요소, HTML의 구조 정의 태그)
		1. [[스크립트릿 공간]] : <%..%>
		2. [[표현식 공간]] : <%=...%>
		3. [[함수 선언부 공간]] : <%!...%>
- 단점 : 문서의 가독성 저하, 문서가 길어지면 유지 + 보수 하기 힘들다

- JSP 스크립트 쓰는 이유
	- 가독성이 좋다
	- 유지 보수하기 좋다
	- 동적 컨텐츠 생상 및 재활용이 가능하다. 
	- 문법적인 공간 변경 없이 표현언어를 사용해 간단하게 구현 가능.
- 주의점 : 표현언어 사용시 동적 요소 공간 -> 정적 요소 공간으로 출력.
  문법적인 공간 변경 없이 수행 하므로, 해석에 주의하자!

>[!note] 내용은 동적, 문법은 정적!?!?!?
>- 내용이 동적이다 
> 	= 자바 코드가 실행될때 실시간으로 데이터베이스와 연동할 시 데이터가 사용자의 입력에 따라 표시되는 내용이 달라지는것.
> 
>- 문법이 정적 
> 	  = JSP 페이지의 전체 구조가 HTML로 정의 되어 있다는 뜻이며, 이런 구조가 고정되어 있다는 뜻

## 6.1 표현 언어
- 표현언어(EL) : JSP 페이지에서 값을 출력하는 언어.
	- 동적인 데이터 접근, 값 표현

### EL 개요
- 동적 요소 사용하는 이유(최종 목표) : 동적으로 생성한 값을 문서에 포함 시키는것
- 자바 구현 스크립트
	- [[스크립트릿 공간]], [[함수 선언부 공간]]에서 자바 문장 사용 -> 필요한 값 동적 생산
		- JSP [[표현식 공간]]에서 자바 표현식을 사용 -> 자바 공간에서 생성한 값을 JSP 문서에 포함.
- JSP 스크립트 요소
	- 액션태그, JSTL 태그, 커스텀 태그 등 사용 -> 값 동적으로 생산
		- EL 사용 -> JSP 문서에 포함
- 자바 구현 스크립트 vs JSP 스크립트 요소
	- 자바 구현 스크립트의 표현식 : 자바 공간([[스크립트릿 공간]] 및 [[함수 선언부 공간]] 공간 등)에서 생성한 값을 JSP 문서로 출력
	- JSP 스크립트 : EL은 JSP문서에서 생산한 값을 그 문서에 정적요소 공간으로 출력
		- EL에서 동적인 출력 값을 정적인 HTML 코드에 삽입한다는 뜻.

- 자바 공간
	1. [[스크립트릿 공간]], [[함수 선언부 공간]] : 값 생산
	2. [[표현식 공간]]: 값 출력
	3. JSP 응답 문서로 넘겨줌
- JSP 문서
	1. 액션태그, JSTL, 커스텀 태그 : 값 생산
	2. EL : 값 출력
	3. JSP 응답 문서로 넘겨줌

- EL은 출력을 위한 값 생산도 수행함.
	- 람다 사용(버전 주의)

| 주요 기능       | 설명                               |
| ----------- | -------------------------------- |
| EL 기본 객체 제공 | 표 6.1.1-1. 과 같은 11개의 EL 기본 객체 제공 |
| 다양한 연산자 제공  | 값 생산을 위한 연산자 제공                  |
| 메서드 호출      | 객체 메서드 및 클래스 메서드 호출              |
| 람다 사용       | 람다 표현식을 사용하는 함수 정의의 실행           |
| 스트림 API 제공  | 기본 컬렉션에 대해 스트림 API 제공            |
| 스크립트 사용     | 자바 구문 스크립트 공간의 4개 영역 객체 사용       |

### EL 기본 문법
- `${ EL표현식 }` 
	- EL 표현식을 정적 바인딩
		- EL 표현식의 값을 런타임 이전에 그 값 결정 후 고정
- `#{ EL표현식 }`
	- EL 표션식을 동적 바인딩
		- 런타임때 EL 표현식의 값을 그때그때 동적으로 결정

- 바인딩(Binding)이란?
	- 프로그램 요소가 가지는 속성에 대해 속성 값을 묶는 행위
	- 속성이 가질 속성의 특정 값을 결정
	- 함수 바인딩 : 함수 호출에 따른 수행될 함수를 결정
	- 데이터 바인딩 : 데이터 사용에 대한 사용될 데이터 결정
- 바인딩 타임(BindingTime)
	- 초기 바인딩(or 정적 바인딩) : 런타임 이전 바인딩 되는것.
	- 후기 바인딩(or 동적 바인딩) : 런타임에 바인딩 하는것.

- EL에 대한 11개의 기본 객체 제공
	- Scope : 영역 객체
	- 나머지 : 요청 파리미터 + 요청 데이터의 다양한 헤더 정보 -> Map 구조의 정보로 제공하는 객체

| 이름               | 설명                                             |
| ---------------- | ---------------------------------------------- |
| pageScope        | page 영역 객체에 저장된 <소스, 값> 매핑을 저장하는 Map 객체        |
| requestScope     | request 영역 객체에 저장된 <소스, 값> 매핑을 저장하는 Map 객체     |
| sessionScope     | session 영역 객체에 저장된 <소스, 값> 매핑을 저장하는 Map 객체     |
| applicationScope | application 영역 객체에 저장된 <소스, 값> 매핑을 저장하는 Map 객체 |
| pageContext      | JSP의 page 관련 객체의 통일                            |
| param            | 요청 파라미터의 <이름, 값> 매핑을 저장하는 Map 객체               |
| initParam        | 시작 파라미터의 <이름, 값> 매핑을 저장하는 Map 객체               |
| header           | 요청 헤더 정보의 <헤더이름, 값> 매핑을 저장하는 Map 객체            |
| headerValues     | 요청 헤더 정보의 <헤더이름, 값> 매핑을 저장하는 Map 객체            |
| cookie           | <쿠키 이름, 쿠키> 매핑을 저장한 Map객체                      |

- EL의 영역 객체(Scope) : 
	- 자바 구현 스크립트에 제공되는 4개 영역 객체에 대해 그 객체에 저장된 속성 정보
		- <속성, 값 객체> 정보를 제공하는 객체
		- Map 구조 정보
		- 자바 구현 스크립트 공간 - EL 공간(JSP 문서) 사이 정보 공유 가능
			- 자바 구현 스크립트에서 생성한 값 -> 자바 구현 스크립트 영역 객체의 속성으로 저장 -> EL 표현식에서는 이러한 EL 영역 객체 사용 -> 값 추출
- EL 기본 객체 사용 : 
	- 게터 사용 X
	- .(점) 연산자 or \[ ](대괄호) -> 프로퍼티 지정
	- 영역 객체 사용시 영역 객체 지정 X
		- 속성 지정만으로도 사용 가능.
		- 아래 영역 순서로 조사 후 저장된 속성 찾음
			1. page
			2. request
			3. session
			4. application

### EL 주요 내용
- 자바 구현 스크립트 표현식의 값 표기(값을 가지는 모든 요소 사용)
	- 상수
	- 리터럴
	- 변수
	- 연산식(연산자와 피연산자의 조합)
	- 함수 호출(값 반환)
- JSP 구현 스크립트(EL)
	- 모든 요소 사용 가능 BUT!!! EL 문법으로 표기
- 데이터 타입([[Data Type]]) : 연산자가 식의 값을 산출 할때 피연산자가 가질 수 있는 값의 종류
	- null : 널타입
	- (나머지 데이터 타입은 아두이노 5주차 데이터 타입 부분과 같음 참조하세요..)

- EL 3.0
	- 배정연산자, 세미콜론 연산자, TLD 사용 X
	- 정적 메서드 사용하기, 람다,스트림 API O
- EL 3.0 배정 연산자
	- 식의 값 생산
	- 식에 사용되는 EL 변수도 생성 + 그 변수에 값 배정
- EL 3.0 세미콜론 연산자
	- 왼쪽에 있는 식 -> 값 소멸
	- 오른쪽에 있는 식 -> 식 값 생산, 출력
	- 쉽게 설명하면 왼쪽에 있는 식을 문자열로 전환시킨다라고 생각하면 됨.

```jsp
<%--EL 3.0의 세미콜론 연산자 사용 / 왼쪽에 있는 연산식의 값은 출력 X--%>
${1+1; 10+20}

${val4 = 10; ' '} <%--' ' 은 빈 문자열 출력--%>

<%--1+1의 값은 출력되지 않고, 10+20의 값만 반환됨.--%>
```

- 이전 버전들은 JSTL의 `<c:set>` 엘리면트를 사용함에 주의

```jsp
<c:set var="val" value = "<%=val1%>" />
```

- EL 표션식
	- => 리터럴 문법 사용 가능
	- 해당 컬렉션 객체 직접 생성 가능

>[!note] 리터럴 문법(literal syntax)
>특정 값이나 데이터를 표현하기 위해 사용하는 고정된 형태의 코드 구성요소.
>"값 그 자체"를 나타냄.(변경X)
>
>ex_)
>- 숫자 리터럴(42, 0.33.......)
>- 문자열 리터럴("여기 안에 있는거")
>- 불리언 리터럴(참/거짓)
>- 배열 리터럴(\[값1, 값2, 값3])
>- 객체 리터럴(키-값 쌍을 포함한 데이터)
>- 정규 표현식 리터럴(문자열 패턴 기반 텍스트 검색 및 대처를 위한 객체)

>[!note] 컬랙션 객체(Collection Object)
>여러개의 데이터를 그룹화 하여 다룰 수 있도록 하는 데이터 구조
>
>- ex_) 리스트, 셋, 맵, 큐, 스택

- EL 변수 사용 : EL 표현식에서 자바 구현 스크립트 객체를 사용하기 위함.
	- 자바 구현 (스크립트 공간에서 생성한) 객체 -> JSTL 사용 -> 영역 객체 -> EL 변수 등록 -> EL 객체의 프로퍼티로 접근 -> 객체 사용
- 최근에는 객체를 직접 사용하는것도 가능
	- 객체 메서드 직접 접근 후 사용(EL최근 버전)

>[!note] JSTL
>- Java Server Pages Standard Tag Library
>- JSP에서 공통적인 기능을 쉽게 구현할 수 있도록 도와주는 태그 라이브러리
>- 커스텀 태그 중 많이 사용하는 태그를 모아놓은 라이브러리
>  (JSP의 자바 코드 간결화, XML 기반 태그 사용)

- EL 이전버전(요즘은 안씀)
	1. (web-info/tld에) TLD(Tag Library Descriptor) 파일 생성 
	2. 클래스와 메서드 관련 태그 지정
	3. TLD 파일을 web.xml에 등록
	4. JSP에서 taglib 디렉티브 사용 
	5. TLD에 지정하는 메서드를 페이지에 끌어다 사용

- 람다(메서드 완성, 클래스 정의, 객체 생성등을 동시에 완성하는 기술) 생성과정
	1. JRE에서 함수적 인터페이스 제공
	2. 람다
	3. 익명 클래스 (1회용) 생성
	4. 객체 생성
- 람다식
	- `형식 매개변수 -> 함수 몸통`
	- 타겟 타입의 인터페이스로 부터 클래스가 만들어짐.
		- 그 클래스로 부터 객체 생성
		- 생성된 객체의 참조값이 람다식의 식의 값이 됨.
- EL에서도 [[람다]] 사용 가능, but 생성되는 람다를 EL 변수에 배정한 후 사용해야 함
```jsp
<%-- (a,b) -> a>b? a:b // EL람다 객체 생성--%>

<%--EL 변수에 람다 배정 // a가 b보다 클때, T 면 a반환, F면 b 반환--%>
${greater = (a,b) -> a>b? a : b;}
```

- 람다 호출 방식
	1. EL 변수에 배정 -> EL 변수 호출
		- EL 변수를 사용 -> 람다의 식별자 반드시 배정 (람다 호출 위함)
	2. 즉시 호출
	3. 재귀적 호출

- 스트림 : 집합자료(컬렉션)에 대해 자료를 구성하는 원소들의 데이터 흐름을 다루는 EL 요소.
	- 집합 자료에 대해 내부 반복자 사용 -> 원소를 연속 처리
	- 반복문 사용 X, 재귀 사용.
	- 중간에 처리되는 결과 -> 다시 스트림 반환 -> 연속적 파이프라인으로 처리
```jsp
${collectionvariable.stream()}
```

>[!note] 형식 매개변수
>임의로 타입을 지정 해놓고 나중에 값이 들어오면 개발자가 타입을 지정 가능하게 하는것.

- java.util.Collection에서 집합 자료에 대해 스트림 추출하기
	- `.stream` 메서드 직접 사용
- 다른 타입의 집합 자료들 : Collection 타입으로 변환, .stream() 메서드 사용

- stream의 메서드 종류
	1. 중간 처리 메서드
	2. 최종 처리 메서드

![[Pasted image 20241215103438.png]]

## 6.2 JSTL
- JSP에서 자바로 동적 요소 구현시 자바문정으로 구현되는 JSP 스크립트릿 사용 -> 변수,객체 생성
- 선택, 반복, 분기 등 각종 제어문 사용
- 문서가 필요로 하는 값 동적 생성
- 자바 표현식 -> JSP 표현식 사용 -> 문서에 출력
- JSP는 동적 요소 구현을 위한 액션 태그 제공
	- 이런 태그만 사용해서는 문서 완성은 어려움
	- 커스텀 태그(Custom Tag) 사용
		- 커스텀 태그란 ? JSP 스크립트 요소로 동적 요소 구현 시 필요한 기능을 개발자가 직접 만들어 사용하는 태그
		- 자주 사용되는 커스텀 태그는 라이브러리로 제공 -> 이게 JSTL

### JSTL 개요
![[Pasted image 20241215104324.png]]

#### core 태그
- 수행 역할
	- EL 변수 생성
	- EL 변수나 프로퍼티에 값 설정
	- 문서의 수행 흐름 제어
	- URL 처리
	- 익셉션 처리
- 문법
	- `<c:~~>`
- 코어 주요 태그

| 기능         | 태그        | 설명                                   |
| ---------- | --------- | ------------------------------------ |
| 변환 생성 및 삭제 | set       | 영역 객체에 EL 변수 생성, 변수에 값 지정            |
|            | remove    | 설정된 변수를 제거한다.                        |
| 흐름 제어      | if        | if블록을 형성한다.                          |
|            | choose    | when, otherwise 태그를 활용해 다중 선택을 수행한다. |
|            | forEach   | 컬렉션의 원소를 순회하며 처리한다.                  |
|            | forTokens | 문자열을 구성하는 토큰을 처리한다.                  |
| 경로 지정      | redirect  | 지정된 경로로 리다이렉트한다.                     |
|            | url       | 절대 경로 혹은 상대 경로로 url작성                |
| 기타         | out       | JspWriter 사용 -> 데이터 출력               |
|            | catch     | 발생한 익셉션을 EL 변수에 저장                   |
- `<c:set>`태그
	- EL변수 생성
	- EL 변수 or 프로퍼티에 값 설정
	- var 속성 사용 
	- 객체 프로퍼티에 값 설정시 target 속성 + property 속성 함께 사용
	- <c:set> 태그 사용 -> EL변수 생성 -> 영역 객체에 그 변수가 속성으로 마련
		-  영역 객체
			- page(지정 x시 자동 page 선택)
			- request
			- session
			- application

```jsp
<%--
var : 값을 저장 할 변수 이름
value : 변수의 값 지정
scope : 변수를 저장할 영역 지정
--%>
<c:set var = "변수명" value = "값" [scope = "영역"]>
<c:set var = "변수명" [scope = "영역"]> 값 </c:set>

<%--
target : 프로퍼티 값을 설정할 대상 객체를 지정, 표현식 or EL로 객체로 지정
property : 값을넣을 프로퍼티이름을 지정, 자바 빈 객체에 대해 프로퍼티 이름에 해당하는 set메서드 반드시 존재
value : 배정할 프로퍼티 값 지정
--%>
<c:set target = "대상 객체" property = "프로퍼티 이름" value = "값">
<c:set target = "대상 객체" property = "프로퍼티 이름"> 값</c:set>
```

- EL변수 영역객체애서 제거
	- `<c:remove>` 태그 사용
	- !!주의!!: 영역 지정 X시 모든 영역의 그 이름의 변수가 모두 제거됨
```jsp
<c:remove var = "변수명" [scope = "영역"]>
```

- core 태그 사용시 문서 흐름 제어
	- `<c:if>`태그 사용
	- test 속성 값으로 표현식, EL, 정적 문자열 가짐.
		- 해당 값이 True면 몸체 내용 처리

- `<c:choose> <c:when>, <c:otherwise>`
	- `<c:choose>` 태그가 `<c:when>, <c:otherwise>` 엘리먼트를 1개의단위로 묶음
	- `<c:choose>`를 순차적으로 수행

```jsp
<c:choose>
	<c:when> <%-- = if--%>
		태그 속성 검사
		만약 true면? 다음 when 실행
	</c:when>
	<c:when> <%-- = else if--%>
		태그 속성 검사
		만약 False면?
	</c:when>
	<c:otherwise> <%-- = else--%>
		수행
	</c:otherwise>
</c:choose>
```

- `<c:forEach>` 태그 (= 향상된 for문)
	- 컬렉션의 모든 원소들을 순차적으로 다루는 반복문태그
	- 추출된 원소가 var 속성으로 지정하는 EL변수에 할당됨.
	- 몸체에서 var가 지정하는 EL 변수를 사용 -> 컬렉션의 원소들을 반복적으로 다룸

```jsp
<c:forEach var = "j" begin = "5" end = "7">
	<c:forEach var = "i" begin = "1" end = "9">
		<li> ${ j } * ${ i } = ${ j * i }
	</c:forEach>
</c:forEach>
```

- `<c:forToken>` 태그
	- 열거되는 토큰들에 대해 각 토큰을 다루는 반복 태그
	- var 속성으로 토큰들이 들어있는 객체를 지정 
	- -> delims 속성으로 토큰을 구분하는 문자 지정(= split 메서드)
		- delims로 구분되는 각 토큰을 순서대로 반복적으로 다룬다.

- `<c:url>` 태그
	- URL 생성 태그
	- `<c:param>` 태그 사용 -> 요청 파라미터 URL에 추가
	- var 속성을 사용 -> 생성된 URL을 EL 변수에 저장
	- scope 속성으로 EL 변수가 저장될 영역 객체 지정

>[!note] 절대 URL, 상대 URL
>- 절대 URL : 리소스 전체 경로를 포함하는 URL
>	- 특징 : 완전한경로(어떤 페이지든 동일하게 작동) + 고유성(항상 특정 리소스 참조)
>	- ex_) 프로토콜, 도메인 명, 전체 경로
>- 상대 URL : 현재 페이지와의 관계 기준, 리소스 가리킴
>	- 특징 : 효율성(간단, 전체 url 필요 X), 유연성(웹 사이트가 구조적으로 변해도 리소스 링크가 유효)
>		- 리소스 : 어떤 시스템이나 환경에서 사용되거나 소비될 수 있는 모든것.
>		- 리소스 경로 != 파일 경로 : 리소스 경로는 리소스를 참조하기 위한 경로일 뿐..

- `<c:redirect>` 태그
	- 지정한 페이지로 리다이렉트 기능 수행
	- `<c:param>` 태그로 요청 파라미터를 리다이렉트시 url에 추가
		- url 속성 값 : `<c:url>`태그의 value 속성의 값과동일
			-  = 절대 url, 상대 url 사용 가능
			- context 속성 사용 -> 다른 컨텍스트 경로도 지정 가능

>[!note] 리다이렉트
>웹 서버가 클라이언트에게 요청한 페이지의 url이 변경되었음을 알리고, 다른 url로 이동하도록 지시하는 기능

- `<c:catch>`태그 ( = try-catch)
	- 발생된 익셉션을 EL 변수에 저장
	- 몸체에서 익셉션 발생시 var 속성이 지정하는 EL 변수에 지정

### fmt 태그
- 리소스를 다루는 태그
	- JSP 페이지에서 리소스 사용
	- 로케일 사용
		- 리소스 번들로부터 해당 언어 및 국가 코드의 리소스를 가져와서 JSP 페이지에서 사용
		- 리소스의 출력 양식을 결정할때 사용되는 태그
- `<fmt:setLocale>` 태그
	- 로케일(Locale) 변경 시 사용하는 태그
	- value 속성
		- 언어코드_국가코드 형식으로 지정
	- scope 속성
		- 지정한 로케일이 영향을 미치는 범위
		- 지정 X시 기본 값으로 page가 됨.
```jsp
<fmt:setLocale value = "ko" scope="request" />
```

- `<fmt:requestEncoding>`태그
	- 요청 파라미터의 캐릭터 인코딩 코드 지정
	- 스크립트릿의 request.setCharacterEncoding()을 수행하는 태그

>[!note] 캐릭터 인코딩
>컴퓨터 시스템에서 문자의 표현 및 저장 방식을 정의하는 규칙.
>문자 -> 숫자 데이터 -> 컴퓨터가 이해 + 처리

- 리소스 번들 (다국어로 리소스 처리시 사용)
	- 서로 다른 언어로 구현되는 동일 내용의 리소스들을 각각의 리소스 파일들로 구현하는 리소스 파일들의 집합을 말함.
	- 파일의 집합 = 폴더로 구현
	- 리소스 폴더 필요
		- 클래스 패스가 걸린 폴더 사용
		- ex_) WEB-INF/classes 하위 폴더
		- .properties 파일로 구현
			- key-value값이 모드 스트링인 Map entry들로 구성되는 파일임.
	- 기본 번들 파일 반드시 포함
	- 언어코드_국가코드 들어간 나머지 번들 파일들로 구성됨
		- ex_)message.properties 기본 번들 파일 + ko 언어코드의 message_ko.properties 번들파일로 구성
- 리소스 번들 준비시
	- `<fmt:bundle>`태그와 `<fmt:message>` 태그 사용 -> 다국어 리소스 처리
	- 처리 과정
		1. `<fmt:bundle>` 태그의 basename 속성 사용 
		2. 리소스 번들 지정 (EL 변수에)
		3. 로케일에 해당하는 파일이 선택 
		4. `<fmt:message>`태그의 key 속성을 사용 
		5. 필요한 리소스를 JSP 페이지로 가져옴
	- <fmt:bundle> 태그의 basename 속성에서 리소스 번들을 지정 할 때 번들 파일들이 위치하는 폴더 이름까지 사용함에 주의
	- `<fmt:message>` 태그에서 bundle 속성사용 -> 번들지정
- `<fmt:formatNumber>` , `<fmt: formatDate>` 태그 사용 -> 출력되는 리소스의 출력 형식 지정
- `<fmt:timeZone>`, `<fmt:setTimeZone>` 태그 사용 -> 시간대별 시간 처리

## 6.3 커스텀 태그
- 액션 태그 + JSTL -> 문서 작성의 효율, 가독성 높이기 위해 사용.
  but 이 둘만 사용하는데 한계.
- => 커스텀 태그 사용으로 해결
- 이전 버전의 커스텀 태그 구현
	1. 태그 구현 .java 작성
	2. .class 로 컴파일
	3. .class 파일을 설정하는 .tld 파일 작성
	4. tld 파일의 web.xml 설정
	5. jsp 페이지에서 \<taglib>로 web.xml 설정 내용 끌어옴
	6. 커스텀 태그 사용
- jsp 2.0 이후 부터는 태그 파일만을 사용하여 커스텀 태그 구현
	1. 커스텀 태그 구현 태그 파일 작성
	2. JSP 페이지에서 \<taglib>로 태그 파일 끌어옴
	3. 커스텀 태그 사용

### 태그 파일 작성과 JSP 페이지의 커스텀 태그 사용
- WEB-INFO/tags 폴더 or 그 하위 폴더에 위치
- 확장자 : .tag, .tagx
- 태그 파일의 이름 : 커스텀 태그의 이름
- JSP 페이지 내 taglib 디렉티브의 tagdir 속성으로 지정해야 함.

- tag 파일 : tag 디렉티브와 태그 파일의 속성 정보를 등록
	- taglib 디렉티브 + include 디렉티브는 JSP 페이지에서의 해당 디렉티브와 동일한 기능 수헹

| 디렉티브      | 기능                                            |
| --------- | --------------------------------------------- |
| tag       | 태그 파일의 설정 정보를 지정한다. JSP 페이지의 page 디렉티브와 동일하다. |
| attribute | 태그 파일이 입력 받을 속성 명시                            |
| variable  | EL 변수로 사용할 변수 정보를 지정한다.                       |
| taglib    | 태그 파일에서 사용할 태그 라이브러리 명시                       |
| include   | 태그 파일에 특정 파일을 포함                              |

| 속성                 | 기능                                                                                  |
| ------------------ | ----------------------------------------------------------------------------------- |
| body-content       | 전달받은 몸체의 종류를 명시한다. empty, scriptless, tagdependent 중 3종 중 1개를 명시해야 같은 scriptless이다. |
| dynamic-attributes | 동적 속성을 사용할 때 속성의 이름을 저장한다. <이름,값>을 저장할  Map 객체를 지정한다. 이러한 Map 객체는 EL에서 변수를 사용한다.    |
| import             | page 디렉티브의 import 속성과 동일 동일하다.                                                      |
| Encoding           | page 디렉티브의 pageEncoding 속성과 동일하다.                                                   |
| isELIgnored        | page 디렉티브의 isELIgnored 속성과 동일하다.                                                    |

### 속성 전달하기
- attribute 디렉티브 사용 -> JSP 페이지가 전달하는 속성을 전달 받을 수 있다.

| 속성          | 기능                                                                   |
| ----------- | -------------------------------------------------------------------- |
| name        | - 태그 파일에서 사용할 속성 이름.<br>- 속성 이름에 대응하는 속성의 값은 태그 파일을 사용하는 JSP페이지에서 제공 |
| required    | - 필수 여부 지정을 나타낸다. false인 경우.                                         |
| rtexprvalue | - 속성 값은 표현식을 사용할 수 있는지 여부를 지정한다. true인 경우.                           |
| type        | - 속성 값의 타입이 클래스를 이름으로 지정한다.                                          |
| fragment    | - 속성 값은 <jsp:attribute> 액션 태그로 전달할 때는 true로 지정한다.                    |
- 태그 파일이 attribute 디렉티브의 fragment 속성을 true로 지정할 경우
	- `<jsp:attribute>` 액션태그 사용 -> 속성 전달
	- `<jsp:invoke>` 액션태그 사용 -> 전달받은 속성 사용
		- 태그 파일의 처리 결과를직접 출력 가능
		- var 속성과 scope 속성을 사용하여 영역 객체에 저장도 가능

- 속성의 개수가 가변적임
	- attribute 디렉티브로 속성을 받을 수 없을때 Map 객체 사용
	- -> 속성을 동적으로 전달받음
	- 태그 파일 tag디렉티브의 dynamic-attribute 속성에 동적 속성 지정할 변수 지정
	- JSP 페이지가 전달하는 속성들을 동적으로 사용 -> java.util.Map 타입의 EL 변수로 변환 -> 태그 파일이 지정한 동적 변수에 전달

### 몸체 다루기
- JSP에서 커스텀 태그 사용시
	- 태그에 몸체를 기술 -> 기술된 몸체도 태그 파일에 전달
		- 시작 태그~종료 태그 사이에서 전달
		- `<jsp:body>` 액션 태그로 몸체를 표현
	- 이때 몸체를 전달받는 태그 파일에서는 `<jsp:doBody>` 액션 태그를 사용
		- tag 디렉티브의 body-content 속성이 scriptless로 설정 
		  -> 전달되는 몸체에는 스크립트 포함 X,
			- EL이나 액션태그 등이 처리된 결과가 전달됨
		- body-content속성이 tagdependent로 설정 -> 몸체 내용을 텍스트로 취급하여 전달

- 태그 파일은 `<jsp:doBody>` 태그 사용 
	- -> 전달되는 몸체 사용
	- 처리 결과를 직접 출력 or var 가 지정하는 EL 변수를 사용하여 영역객체에 저장도 가능
	- `<c:forEach>`를 사용하여 전달된 몸체를 반복사용 가능

### 변수 다루기
- 태그 파일에서 variable 디렉티브를 사용 -> JSP 페이지에 EL 변수 제공
- variable 디렉티브에서 name-given 속성으로 EL 변수 지정
- JSP 페이지에서 이러한 EL 변수 사용시 태그 파일의 variable 디렉티브의 scope 속성에서 지정한 범위에서 EL 변수 사용

![[Pasted image 20241215165657.png]]

- 아래 속성 사용시 JSP 페이지에서 태그 파일이 제공하는 EL 변수의 이름도 JSP 페이지에서 결정 가능
	- attribute 디렉티브의 name 속성
	- variable 디렉티브의 name-from-attribute 속성
	- alias 속성 

