# 섹션 1 : 아키텍처 요구사항
- 카페에서 온라인 주문 기능 도입 요구!

# 섹션 2 : Amazon EC2를 사용하여 컴퓨팅 추가
- 주요 런타임 컴퓨팅 옵션
	1. 가상머신
		1. Amazon Elastic Compute Cloud(Amazon EC2) 제공 : 클라우드에서 안전, 크기 조정이 가능한 가상 서버 제공
		2. Amazon Lightsail : 가상 프라이빗 서버 사용 -> 비용 효율적인 방식으로 간단한 워크로드 실행
	2. 컨테이너
		- Amazon Elastic Container Service(Amazon ECS) 제공
		- ex_) Docker ...
	3. PaaS : 서비스형 플랫폼(클라우드 쪽에서 개발, 실행환경을 모두 제공)
		- Amazon Elastic Beanstalk
		- java, .NET, PHP, Node.js, python, 등과같은 언어로 개발된 웹 애플리케이션 실행 가능
	4. 서버리스
		- AWS Lambda 포함
		- AWS Fargate(컨테이너를 위한 서버리스)
		- java, Go, Powershell, Node.js, C#, Python, Ruby 코드 실행
	- + 전문 솔루션 -> 특정 컴퓨팅 사용 사례 지원
		- 온프레미스에서 AWS인프라 및 서비스를 실행 할 수 있는 방법 제공
		- AWS Batch : 규모 관계 X, 배치 작업 실행

## Amazon EC2
- 클라우드에서 크기 조정이 가능한 컴퓨팅 용량 제공
- 가상머신 (서버) 제공
- 몇분만에 서버 프로비저닝
- 필요에 따라 용량을 자동으로 확장 or 축소 가능(탄력적)
- 사용한 용량에 대해서만 비용 지불(다른 서비스와 함께 연동)

## EC2 인스턴스
- 물리적 호스트에서 실행되는 가상 머신(다양한 OS)
	- 하이퍼바이저 계층 기반으로 가상머신이 실행됨.
		- 하이퍼바이저 : 여러개의 가상머신을 만듦 -> 동시에 실행
	- 다양한 CPU 및 메모리 용량 구성을 선택 가능
	- 다양한 스토리지 옵션 지원
		- 인스턴스 스토어 : 휘발성 스토리지
			- 호스트 컴퓨터에 물리적으로 연결된 스토리지로 인스턴스에 임시 블록 수준 스토리지 제공
		- Amazon Elastic Block Store(Amazon EBS) : 일종의 가상 하드 디스크로, 
		  저장소(EBS)와 기타 네트워크 트래픽을 분리하여 더 빠르고 안정적으로 사용 가능하다.
- EC2끼리 네트워크로 연결 가능

![[Pasted image 20251020195734.png]]

## Amazon EC2 사용 사례
- 운영체제 및 프로세서 유형을 비롯한 컴퓨팅 리소스의 완벽한 제어
- 컴퓨팅 비용 최적화를 위한 옵션
	- 온디멘드 인스턴스 : 필요시 사용
	- 예약 인스턴스 : 약정
	- 스팟 인스턴스 : 서버가 자주 바뀜
- 모든 유형의 워크로드를 실행 할 수 있는 기능
	- 간단한 웹사이트
	- 엔터프라이즈 애플리케이션
	- 고성능 컴퓨팅 애플리케이션
- 용도
	1. 웹서버
	2. 애플리케이션 서버
	3. 데이터베이스 서버
	4. 미디어 서버
- 특징
	- 컴퓨팅 리소스 완벽 제어 : 모든 것을 제어 가능
	- 컴퓨팅 비용 최적화 옵션 : 다양한 요금 옵션 제공(온디맨드 인스턴스, Saving Plans..)
	- 모든 유형의 워크로드를 실행하는 가상 서버

## EC2인스턴스 프로비저닝
- 필수 인스턴스 시작 구성 파라미터 
	1. Amazon Machine Image(AMI) : 인스턴스의 기본 소프트웨어 구성 정의, 인스턴스 시작하는데 사용됨
	2. 인스턴스 유형 : 애플리케이션 실행을 위한 컴퓨팅 기능을 제공(CPU, 메모리, 스토리지 , 네트워킹)
	3. 네트워크 배치 및 주소 지정 : 적절한 네트워크 배치 및 주소 지정 -> 원하는 수준의 네트워크 엑세스 및 보안 제공
	4. 위임된 역할 : 필요에 따라 IAM역할 ([[모듈 2 - 클라우드의 경제성 및 결제#보안]]참조) 연결 가능
	5. 사용자 데이터 : 사용자 데이터 스크립트지정 -> 인스턴스 구성 추가 초기화 or 사용자 지정
		- 인스턴스가 시작될때 자동으로 시작
	6. 스토리지 : 인스턴스의 루트 or 부팅 볼륨을 저장하는데 사용할 스토리지 유형 저장 해야함
	7. 보안그룹 : 네트워크 트래픽이 허용되는 포트 정의
	8. 키 페어 : (시작 시에도 지정) SSH 연결 or 인스턴스에 대한 원격 데스크톱 프로토콜 엑세스 설정시 사용

# 섹션 3 : EC2 인스턴스를 시작하기 위한 AMI 선택
-  AMI : 인스턴스 시작 시 필요한 정보 제공
- 인스턴스 시작 시 필요한 소스 지정
	1. 루트 볼룸용 템플릿
		- 게스트 운영체제(OS) 및 설치된 다른 소프트웨어 포함
	2. 시작 권한
		- AMI에 액세스 할 수 있는 AWS 계정 제어
	3. 블록 디바이스 매핑
		- 인스턴스에 연결할 스토리지 볼륨 지정

## AMI의 이점
- 반복성 : 하나를 재사용 가능
	- AMI 반복 사용 -> 높은 효율성과 정밀도로 인스턴스를 시작 가능
- 재사용성 : 동일 구성 
- 복구성 : 문제 발생시 똑같은 이미지로 북구 가능
	- 구성된 인스턴스에서 복원 가능
	- 백업으로서 AMI를 생성 가능
	- 실패한 인스턴스 교체 가능

## AMI 선택
- 선택 기준
	1. 리전 
	2. 운영체제 : window, Linux
	3. 루트 디바이스의 스토리지 유형
		1. 인스턴스 스토어 : 볼륨의 데이터는 인스턴스 수명 동안에만 유지
		2. Amazon EBS : 인스턴스 수명과 관계 없이 유지됨
	4. 아키텍쳐
	5. 가상화유형
		1. 반 가상화
		2. 가상 머신 - 최상의 성능
- AMI 소스
	1. Quick Start : AWS에서 제공하는 Linux 및 WIndows AMI - 운영체제 선택
	2. 내 AMI :사용자가 생성한 모든 AMI
	3. AWS MArketplace : 서드 파티의 사전 구성된 템플릿
	4. 커뮤니티 AMI : 다른 사람이 공유하는 AMI , 사용에 따른 위험은 사용자가 부담

## 인스턴스 스토어 지원 AMI와 Amazon EBS-backed AMI
- 특성 : 인스턴스의 부팅 시간(속도 - 누가 더 빠른지)
	- Amazon EBS 지원 인스턴스 > 인스턴스 스토어 지원 인스턴스
- 특성 : 루트 디바이스의 최대 크기
	- Amazon EBS 지원 인스턴스(16TiB) > 인스턴스 스토어 지원 인스턴스(10GiB)
- 특성 : 인스턴스 중지 기능
	-  Amazon EBS 지원 인스턴스 - 중지 가능
	- 인스턴스 스토어 지원 인스턴스 - 중지 불가, 재부팅 or 종료
- 특성 : 인스턴스 유형을 변경하는 기능
	- Amazon EBS 지원 인스턴스 - 가능
	- 인스턴스 스토어 지원 인스턴스 - 불가능
- 특성 : 인스턴스 요금
	- Amazon EBS 지원 인스턴스 : AMI EBS 스냅샷으로 저장하는데 따른 요금 청구
	- 인스턴스 스토어 지원 인스턴스 : S3에 AMI를 저장하는데 따른 비용 청구됨 - 저렴

## Amazon EC2 인스턴스 수명 주기
1. 인스턴스가 AMI에서 처음 시작 or 중지된 인스턴스 시작 -> 대기중 상태
	- 인스턴스가 호스트 컴퓨터에서 프로비저닝 되고 부팅되는 중임
	- AMI에 지정된 인스턴스 유형 or 중지된 원래 인스턴스에 따라 새 인스턴스에 사용할 호스트 컴퓨터의 하드웨어가 결정됨
2. 인스턴스 부팅준비되면 대기중 -> 실행중으로 바뀜
	- 인스턴스에 인터넷 연결하여 사용 시작
3. 여러 옵션을 사용하여 인스턴스 재부팅 가능(Amazon EC2 콘솔, CLI, AWS SDK)
4. 재부팅 되면 동일한 물리적 호스트에 유지, public DNS이름과 IP주소 동일 유지됨
5. 실행중 상태에서 인스턴스 종료 가능
	- 중지중 비용 발생 가능성

## 새로운 AMI 생성
1. AMI생성
2. 인스턴스 시작
3. 수정되지 않은 인스턴스
4. 수정시킴
5. 새 AMI
6. (선택) AMI를 사용하려는 다른 리전에 AMI 복사
7. 새로운 AMI

## EC2 Image Builder
- AMI를 생성하는 또다른 방법
- 규정에 부합하는 최신 골든(최종 ver)VM 이미지의 생성, 관리, 배포 자동화
	- 골든 VM : 회사의 규정에 맞춰진 최종 버전의 가상 머신
	- 이미지 구축 파이프라인 생성을 위한 GUI제공
	- Amazon EC2 AMI 및 온프레미스 VM 이미지 생성/유지 관리
	- 안전하고 검증된 최신 이미지 생성
	- 버전 제어 적용

### EC2 Image Builder의 작동 방식
1. 이미지 만드는데 사용할 소스 이미지 식별(Window , Linux)
2. 설치 또는 사용자 지정 빌드 구성 요소 소프트웨어 선택
3. 이미지가 보안 검사를 통과하도록 이미지 파이프라인을 실행 할때마다 실행해야 하는 강화 테스트 선택
	1. OS 업데이트로 인해 발생하는 호환성이 맞지 않는 문제 파악 가능
4. 파이프라인의 실행 빈도와 시기를 결정하는 빌드 일정 지정
5. 이미지를 선택된 리전에 배포할지 여부 정의

>[!warning] 여기서 말하는 이미지는 그림이 아니다!!@@
>EC2 인스턴스를 실행하기 위한 **운영체제 + 설정 + 패키지 + 정책**이  
모두 포함된 **서버 템플릿(AMI)** 을 뜻함.

# 섹션 4 : EC2 인스턴스 유형 선택
## EC2 인스턴스 유형
- 인스턴스 시작시 먼저 사용할 인스턴스 유형 선택
	- CPU, 메모리, 스토리지 및 네트워크 성능 특성의 구성
- ex_) m5d.xlarge
	- m : 패밀리 네임
	- 5 : 해당 유형의 세대 번호
	- d : 인스턴스 유형의 추가 기능 - SSD를 사용함
	- xlarge : 인스턴스의 크기

## 워크로드에 대한 인스턴스 유형의 적합성
- 인스턴스 유형
	1. 범용
	2. 컴퓨팅
	3. 최적화
	4. 메모리 최적화
	5. 가속화 컴퓨팅
	6. 스토리지 최적화
1. 범용 인스턴스 : 컴퓨팅, 메모리, 네트워킹 리소스를 균형있게 제공(다양한 워크로드에 사용 가능)
	1. 웹, 애플리케이션 서버
	2. 엔터프라이즈 애플리케이션
	3. 게임서버
	4. 캐싱플릿
	5. 분석 애플리케이션
	6. 개발 또는 테스트 환경
2. 컴퓨팅 최적화 인스턴스 : 고성능 프로세서 사용
	1. 배치처리
	2. 분산 분석
	3. 고성능 컴퓨팅
	4. AD서버 엔진
	5. 멀티 플레이어 게임
	6. 동영상 인코딩
3. 메모리 최적화 인스턴스 유형(R5, X1, HMI 인스턴스)
	1. 인 메모리 캐시
	2. 고성능 데이터베이스
	3. 빅데이터 분석
4. 가속화 컴퓨팅 인스턴스 유형(P3, G4, F1)
	1. 기계학습, 인공지능
	2. HPC
	3. 그래픽
5. 스토리지 최적화 인스턴스 유형(I3, D2, H1)
	1. 고성능 데이터베이스
	2. 실시간 분석
	3. 트랜잭션 워크로드
	4. NoSQL 데이터베이스
	5. 빅데이터
	6. 데이터 웨어하우스
	7. 로그 처리

## 인스턴스 유형 선택
- 애플리케이션의 성능 요구 사항
- 비용 요구 사항
- 새 인스턴스 생성시 
	- EC2 콘솔에서 Instance Types 페이지 사용 -> 선택한 특성을 기준으로 필터링
- 기존 인스턴스가 이미 있는 경우 : AWS Compute Optimizer 사용 -> 인스턴스 유형 최적화 권장사항 참조

# 섹션 5 : 사용자 데이터를 사용하여 EC2인스턴스 구성
## EC2 인스턴스 사용자 데이터
- 인스턴스 시작시 초기화 스크립트(셸 스크립트 또는 cloud - init 지시문)를 실행할 사용자 데이터 지정
- 사용자의 AMI -> 사용자 데이터 -> EC2인스턴스 실행

## 인스턴스 메타데이터 가져오기
- 인스턴스 메타데이터 : 인스턴스에 대한 정보
- URL의 인스턴스에서 액세스 할 수 있음
- 사용자 데이터 스크립트에서 검색 가능
- 사용자 데이터가 새 EC2인스턴스 시작을 완료 하려면 인스턴스 자체에 대한 정보 조회 필요
	- IP, 호스트 이름 , 미디어 액세스 제어 주소 식별 , 공유 필요

## EC2 인스턴스 구성 : AMI vs 사용자 데이터
- 간편성과 유연성의 절충점을 고려해야 하는 요소들
	- 빌드 시간
	- 부팅 시간
	- 수명
- 장단점
	- 완전구성 AMI : 애플리케이션과 모든 종속성이 사전 설치 되어 있어 부팅 시간은 단축
	  , but 빌드 시간 늘어남
		- 수명 짧음
		- 롤백 전략 고려
	- 하이브리드(부분적으로 구성된)AMI : 필수 소프트웨어 및 유틸리티만 사전 설치됨 -> AMI의 수명 길어짐.
		- 부팅 속도와 빌드 시간이 균등
	- OS 전용 AMI : 시간이 지나면 완벽하게 업그레이드 가능
		- 구축 시간 단축
		- 필요한 모든 설치 및 구성을 부팅시에 실행 -> 부팅 속도 느림

![[Pasted image 20251020232105.png]]

# 섹션 6 : Amazon EC2 인스턴스에 스토리지 추가
- EC2 인스턴스의 기본 스토리지 옵션 - 모두 데이터 볼륨 저장하는데 사용 가능
	- 
	1. 인스턴스 스토어
	2. Amazon EBS
	3. Amazon Elastic File System(Amazon EFS)
	4. Windows FIle Server용 Amazon FSx
- 

# 섹션 7 : Amazon EC2 요금 옵션

# 섹션 8 : Amazon EC2 고려사항